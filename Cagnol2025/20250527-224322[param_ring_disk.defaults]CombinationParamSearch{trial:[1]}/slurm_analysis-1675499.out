  Starting NeuronAnnotationsToPerNeuronValues analysis
  Starting NeuronAnnotationsToPerNeuronValues Analysis
  Warning: ADS with the same parametrization already added in the datastore.: {"module_path" :"mozaik.analysis.data_structures","analysis_algorithm":'NeuronAnnotationsToPerNeuronValues', "identifier":'PerNeuronValue', "name":'PerNeuronValue', "neuron":None, "period":None, "sheet_name":'V1_Exc_L4', "stimulus_id":None, "value_name":'LGNAfferentAspectRatio'}
  Warning: ADS with the same parametrization already added in the datastore.: {"module_path" :"mozaik.analysis.data_structures","analysis_algorithm":'NeuronAnnotationsToPerNeuronValues', "identifier":'PerNeuronValue', "name":'PerNeuronValue', "neuron":None, "period":6.283185307179586, "sheet_name":'V1_Exc_L4', "stimulus_id":None, "value_name":'LGNAfferentPhase'}
  Warning: ADS with the same parametrization already added in the datastore.: {"module_path" :"mozaik.analysis.data_structures","analysis_algorithm":'NeuronAnnotationsToPerNeuronValues', "identifier":'PerNeuronValue', "name":'PerNeuronValue', "neuron":None, "period":None, "sheet_name":'V1_Exc_L4', "stimulus_id":None, "value_name":'aff_samples'}
  Warning: ADS with the same parametrization already added in the datastore.: {"module_path" :"mozaik.analysis.data_structures","analysis_algorithm":'NeuronAnnotationsToPerNeuronValues', "identifier":'PerNeuronValue', "name":'PerNeuronValue', "neuron":None, "period":None, "sheet_name":'V1_Exc_L4', "stimulus_id":None, "value_name":'LGNAfferentFrequency'}
  Warning: ADS with the same parametrization already added in the datastore.: {"module_path" :"mozaik.analysis.data_structures","analysis_algorithm":'NeuronAnnotationsToPerNeuronValues', "identifier":'PerNeuronValue', "name":'PerNeuronValue', "neuron":None, "period":None, "sheet_name":'V1_Exc_L4', "stimulus_id":None, "value_name":'LGNAfferentY'}
  Warning: ADS with the same parametrization already added in the datastore.: {"module_path" :"mozaik.analysis.data_structures","analysis_algorithm":'NeuronAnnotationsToPerNeuronValues', "identifier":'PerNeuronValue', "name":'PerNeuronValue', "neuron":None, "period":3.141592653589793, "sheet_name":'V1_Exc_L4', "stimulus_id":None, "value_name":'LGNAfferentOrientation'}
  Warning: ADS with the same parametrization already added in the datastore.: {"module_path" :"mozaik.analysis.data_structures","analysis_algorithm":'NeuronAnnotationsToPerNeuronValues', "identifier":'PerNeuronValue', "name":'PerNeuronValue', "neuron":None, "period":None, "sheet_name":'V1_Exc_L4', "stimulus_id":None, "value_name":'LGNAfferentX'}
  Warning: ADS with the same parametrization already added in the datastore.: {"module_path" :"mozaik.analysis.data_structures","analysis_algorithm":'NeuronAnnotationsToPerNeuronValues', "identifier":'PerNeuronValue', "name":'PerNeuronValue', "neuron":None, "period":None, "sheet_name":'V1_Exc_L4', "stimulus_id":None, "value_name":'LGNAfferentSize'}
  Warning: ADS with the same parametrization already added in the datastore.: {"module_path" :"mozaik.analysis.data_structures","analysis_algorithm":'NeuronAnnotationsToPerNeuronValues', "identifier":'PerNeuronValue', "name":'PerNeuronValue', "neuron":None, "period":None, "sheet_name":'V1_Inh_L4', "stimulus_id":None, "value_name":'LGNAfferentAspectRatio'}
  Warning: ADS with the same parametrization already added in the datastore.: {"module_path" :"mozaik.analysis.data_structures","analysis_algorithm":'NeuronAnnotationsToPerNeuronValues', "identifier":'PerNeuronValue', "name":'PerNeuronValue', "neuron":None, "period":6.283185307179586, "sheet_name":'V1_Inh_L4', "stimulus_id":None, "value_name":'LGNAfferentPhase'}
  Warning: ADS with the same parametrization already added in the datastore.: {"module_path" :"mozaik.analysis.data_structures","analysis_algorithm":'NeuronAnnotationsToPerNeuronValues', "identifier":'PerNeuronValue', "name":'PerNeuronValue', "neuron":None, "period":None, "sheet_name":'V1_Inh_L4', "stimulus_id":None, "value_name":'aff_samples'}
  Warning: ADS with the same parametrization already added in the datastore.: {"module_path" :"mozaik.analysis.data_structures","analysis_algorithm":'NeuronAnnotationsToPerNeuronValues', "identifier":'PerNeuronValue', "name":'PerNeuronValue', "neuron":None, "period":None, "sheet_name":'V1_Inh_L4', "stimulus_id":None, "value_name":'LGNAfferentFrequency'}
  Warning: ADS with the same parametrization already added in the datastore.: {"module_path" :"mozaik.analysis.data_structures","analysis_algorithm":'NeuronAnnotationsToPerNeuronValues', "identifier":'PerNeuronValue', "name":'PerNeuronValue', "neuron":None, "period":None, "sheet_name":'V1_Inh_L4', "stimulus_id":None, "value_name":'LGNAfferentY'}
  Warning: ADS with the same parametrization already added in the datastore.: {"module_path" :"mozaik.analysis.data_structures","analysis_algorithm":'NeuronAnnotationsToPerNeuronValues', "identifier":'PerNeuronValue', "name":'PerNeuronValue', "neuron":None, "period":3.141592653589793, "sheet_name":'V1_Inh_L4', "stimulus_id":None, "value_name":'LGNAfferentOrientation'}
  Warning: ADS with the same parametrization already added in the datastore.: {"module_path" :"mozaik.analysis.data_structures","analysis_algorithm":'NeuronAnnotationsToPerNeuronValues', "identifier":'PerNeuronValue', "name":'PerNeuronValue', "neuron":None, "period":None, "sheet_name":'V1_Inh_L4', "stimulus_id":None, "value_name":'LGNAfferentX'}
  Warning: ADS with the same parametrization already added in the datastore.: {"module_path" :"mozaik.analysis.data_structures","analysis_algorithm":'NeuronAnnotationsToPerNeuronValues', "identifier":'PerNeuronValue', "name":'PerNeuronValue', "neuron":None, "period":None, "sheet_name":'V1_Inh_L4', "stimulus_id":None, "value_name":'LGNAfferentSize'}
  Warning: ADS with the same parametrization already added in the datastore.: {"module_path" :"mozaik.analysis.data_structures","analysis_algorithm":'NeuronAnnotationsToPerNeuronValues', "identifier":'PerNeuronValue', "name":'PerNeuronValue', "neuron":None, "period":3.141592653589793, "sheet_name":'V1_Exc_L2/3', "stimulus_id":None, "value_name":'LGNAfferentOrientation'}
  Warning: ADS with the same parametrization already added in the datastore.: {"module_path" :"mozaik.analysis.data_structures","analysis_algorithm":'NeuronAnnotationsToPerNeuronValues', "identifier":'PerNeuronValue', "name":'PerNeuronValue', "neuron":None, "period":3.141592653589793, "sheet_name":'V1_Inh_L2/3', "stimulus_id":None, "value_name":'LGNAfferentOrientation'}
NeuronAnnotationsToPerNeuronValues analysis took: 24.29381823539734seconds
  {47360, 18817, 22403, 20486, 24455, 43271, 50824, 15115, 31628, 36108, 33040, 15637, 50455, 49561, 24989, 38562, 38690, 18723, 26149, 48037, 35623, 35240, 29609, 28843, 40235, 20274, 20915, 47923, 45369, 46406, 41671, 23240, 37835, 44365, 34127, 23892, 28792, 16093, 23133, 34141, 21088, 33376, 14695, 36711, 26600, 23658, 26738, 49138, 48627, 26100, 46196, 26229, 44534, 21243, 27134}
  {79489, 73475, 77062, 61703, 84746, 92426, 83981, 80014, 61716, 62358, 74902, 81302, 85782, 77463, 89368, 81052, 70648, 90524, 95644, 85797, 77606, 92842, 95149, 81203, 83382, 85303, 64185, 92475, 66496, 75970, 84546, 79427, 65860, 79686, 77640, 64713, 98249, 73674, 74703, 74449, 91858, 97875, 94421, 62299, 84699, 64993, 70372, 88804, 67436, 92782, 98544, 90740, 70263, 62456, 83193, 74111}
  Starting LinearityIndices analysis
/home/cagnol/virt_env/mozaik_paper_test2/lib/python3.12/site-packages/mozaik/analysis/vision.py:882: RuntimeWarning: divide by zero encountered in divide
  lis.append(100*((disk[-1]-ring[-1] - (disk[1:] + ring[1:] - 2*ring[-1]))/(disk[-1]-ring[-1])))
/home/cagnol/virt_env/mozaik_paper_test2/lib/python3.12/site-packages/mozaik/analysis/vision.py:882: RuntimeWarning: invalid value encountered in divide
  lis.append(100*((disk[-1]-ring[-1] - (disk[1:] + ring[1:] - 2*ring[-1]))/(disk[-1]-ring[-1])))
Traceback (most recent call last):
  File "/home/cagnol/mozaik-models_github/mozaik-models/Cagnol2025/run_analysis.py", line 22, in <module>
    perform_analysis_and_visualization_ring_disk(data_store)
  File "/home/cagnol/mozaik-models_github/mozaik-models/Cagnol2025/analysis_and_visualization.py", line 1054, in perform_analysis_and_visualization_ring_disk
    LinearityIndices(param_filter_query(data_store, sheet_name=sheets),ParameterSet({'value_name':'Firing rate'})).analyse()
  File "/home/cagnol/virt_env/mozaik_paper_test2/lib/python3.12/site-packages/mozaik/analysis/analysis.py", line 75, in analyse
    self.perform_analysis()
  File "/home/cagnol/virt_env/mozaik_paper_test2/lib/python3.12/site-packages/mozaik/analysis/vision.py", line 889, in perform_analysis
    self.datastore.full_datastore.add_analysis_result(PerNeuronValue(list(lsi[:,i]), ids,None,value_name = 'LI ' + self.parameters.value_name,sheet_name=sheet,tags=self.tags,period=None,analysis_algorithm=self.__class__.__name__,stimulus_id=str(sts[i])))
                                                                          ^^^
NameError: name 'lsi' is not defined
